
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <title>CareKKWeb</title>

  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lobster" />

  <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>

  <!-- Core plugin JavaScript-->
  <script src="{% static 'vendor/jquery-easing/jquery.easing.min.js' %}"></script>

  <!-- Page level plugin JavaScript-->
  <script src="{% static 'vendor/chart.js/Chart.min.js' %}"></script>
  <script src="{% static 'vendor/datatables/jquery.dataTables.js' %}"></script>
  <script src="{% static 'vendor/datatables/dataTables.bootstrap4.js' %}"></script>

  <!-- Custom scripts for all pages-->
  <script src="{% static 'js/sb-admin.min.js' %}"></script>

  <!-- Demo scripts for this page-->
  <script src="{% static 'js/demo/datatables-demo.js' %}"></script>
  <script src="{% static 'js/demo/chart-area-demo.js' %}"></script>

  <!-- Custom fonts for this template-->
  <link href="{% static 'vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet" type="text/css">

  <!-- Page level plugin CSS-->
  <link href="{% static 'vendor/datatables/dataTables.bootstrap4.css' %}" rel="stylesheet">

  <!-- Custom styles for this template-->
  <link href="{% static 'css/sb-admin.css' %}" rel="stylesheet">
</head>
<style>
#bg{
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: top;
    background-attachment: fixed;
}

h1 { font-family: Lobster; 
font-size: 48px; 
font-style: normal; 
font-variant: normal; 
font-weight: 700; 
line-height: 26.4px; 
color: aliceblue;} 

.center {
  margin: auto;
  padding: 10px;
  text-align: center;
}

.cards {
  margin: auto;
  padding: 100px;
}

.deckBorder {
  position: absolute;
  border-style: solid;
  border-color: yellow;
  border-radius: 10px;
  width: 100px;
  height: 150px;
  top: 50%;
  left: 50%;
  transform: translate(-250px,-75px);
  padding-left: 10px;
  padding-top: 15px;
}

.dumpBorder {
  position: absolute;
  border-style: solid;
  border-color: blue;
  border-radius: 10px;
  width: 300px;
  height: 150px;
  top: 50%;
  left: 50%;
  transform: translate(-125px,-75px);
  padding-left: 100px;
  padding-top: 15px;
}

.homeButton{
  width: 200px;
}

.card{
  position: absolute;
}
</style>

<body id="bg" style="background-image: url('{% static "src/images/greenTable.png" %}')";>



  <div id="player2Id">
  </div>

  <div id="DeckAndDump">
    <div id="deck" class="deckBorder">
      <img class = "card" width="75px" src='{% static "src/images/cardsBack.png" %}'>
    </div>
    <div id="dump" class="dumpBorder">
        <img class = "card" width="75px" src='{% static "src/images/2pica.png" %}'>
    </div>
  </div>

  <div id="player1Id" value=1>
  </div>

</body>

<script>

function setPlayerFieldCards(field,playerId,ref,ypos,divId,cardId){
  var i=field.length;
  var totalWidth=screen.width;

  if(i%2==0){
    for(var j=0;j<i/2;j++){

      var div = document.createElement("div");
      div.setAttribute("id",divId+j);
      document.getElementById(playerId).appendChild(div);
      var img =document.createElement("img");
      img.setAttribute("valuex",(totalWidth/2-75*(j+1)));
      img.setAttribute("valuey",(ypos));
      img.setAttribute("class","card");
      img.setAttribute("id",cardId+j);
      img.setAttribute("width","75px");
      img.setAttribute("src",field[(i/2-1)-j]);
      if (ref=="top"){
        img.style.top=(ypos)+"px";
      }else{
        img.style.bottom=(ypos)+"px";
      }
      
      img.style.left=(totalWidth/2-75*(j+1))+"px";
      document.getElementById(divId+j).appendChild(img);
    };

    for(var j=i/2;j<i;j++){

      var div = document.createElement("div");
      div.setAttribute("id",divId+j);
      document.getElementById(playerId).appendChild(div);

      var img =document.createElement("img");
      img.setAttribute("valuex",(totalWidth/2+75*(j-i/2)));
      img.setAttribute("valuey",(ypos));
      img.setAttribute("class","card");
      img.setAttribute("id",cardId+j);
      img.setAttribute("width","75px");
      img.setAttribute("src",field[j]);
      if (ref=="top"){
        img.style.top=(ypos)+"px";
      }else{
        img.style.bottom=(ypos)+"px";
      }
      img.style.left=(totalWidth/2+75*(j-i/2))+"px";
      document.getElementById(divId+j).appendChild(img);
    };


  }else{
    var mediana=i/2-0.5;
    for(var j=0;j<mediana;j++){
      var div = document.createElement("div");
      div.setAttribute("id",divId+j);
      document.getElementById(playerId).appendChild(div);

      var img =document.createElement("img");
      img.setAttribute("valuex",(totalWidth/2-75*(j+2)+37.5));
      img.setAttribute("valuey",(ypos));
      img.setAttribute("class","card");
      img.setAttribute("id",cardId+j);
      img.setAttribute("width","75px");
      img.setAttribute("src",field[(mediana-1)-j]);
      img.style.top=(ypos)+"px";
      img.style.left=(totalWidth/2-75*(j+2)+37.5)+"px";
      document.getElementById(divId+j).appendChild(img);

    };



    var div = document.createElement("div");
    div.setAttribute("id",divId+mediana);
    document.getElementById(playerId).appendChild(div);

    var img =document.createElement("img");
    img.setAttribute("valuex",(totalWidth/2-37.5));
    img.setAttribute("valuey",(ypos));
    img.setAttribute("class","card");
    img.setAttribute("id",cardId+mediana);
    img.setAttribute("width","75px");
    img.setAttribute("src",field[mediana]);
    img.style.top=(ypos)+"px";
    img.style.left=(totalWidth/2-37.5)+"px";
    document.getElementById(divId+mediana).appendChild(img);


    for(var j=mediana+1;j<i;j++){

      var div = document.createElement("div");
      div.setAttribute("id",divId+j);
      document.getElementById(playerId).appendChild(div);

      var img =document.createElement("img");
      img.setAttribute("valuex",(totalWidth/2+75*(j-mediana)-37.5));
      img.setAttribute("valuey",(ypos));
      img.setAttribute("class","card");
      img.setAttribute("id",cardId+j);
      img.setAttribute("width","75px");
      img.setAttribute("src",field[j]);
      img.style.top=(ypos)+"px";
      img.style.left=(totalWidth/2+75*(j-mediana)-37.5)+"px";
      document.getElementById(divId+j).appendChild(img);
    };


  }


  
}





setPlayerFieldCards({{p1CloseField|safe}},"player1Id","bottom",175,"divP1Close","imgP1CloseCard");
setPlayerFieldCards({{p2CloseField|safe}},"player2Id","top",175,"divP2Close","imgP2CloseCard");

setPlayerFieldCards({{p1OpenField|safe}},"player1Id","bottom",200,"divP1Open","imgP1OpenCard");
setPlayerFieldCards({{p2OpenField|safe}},"player2Id","top",200,"divP2Open","imgP2OpenCard");

setPlayerFieldCards({{p1Hand|safe}},"player1Id","bottom",50,"divP1Hand","imgP1HandCard");
setPlayerFieldCards({{p2Hand|safe}},"player2Id","top",50,"divP2Hand","imgP2HandCard");








</script>


<script>
let cardId;
let cardTop;
let cardLeft;

function addListeners() {
    window.addEventListener('mousedown',mouseDown,false);
    window.addEventListener('mouseup', mouseUp, false);
}

function cardToRespectivePosition(){
  var totalWidth=screen.width;
  var totalHeigh=screen.height;
  var div = document.getElementById(cardId);
  div.style.position = 'absolute';
  div.style.bottom = (cardTop)+"px";
  let i=cardId.slice(4);
  div.style.left=cardLeft+"px";
}

function mouseUp() {
  cardToRespectivePosition();
  window.removeEventListener('mousemove', divMove, true);
  cardId=null;
  cardLeft=null;
  cardTop=null;
}

function mouseDown(e) {

    if (e.explicitOriginalTarget.parentNode.parentNode.id=="player1Id"){
      cardTop=e.target.attributes.valuey.value;
      cardLeft=e.target.attributes.valuex.value;
      cardId=e.target.id;
      window.addEventListener('mousemove', divMove, true);
    }
}

function divMove(e){
  var div = document.getElementById(cardId);
  div.style.position = 'absolute';
  div.style.bottom = (screen.height-(e.clientY+50)) + 'px';
  div.style.left = (e.clientX-35) + 'px';
}


addListeners();
</script>

</html>